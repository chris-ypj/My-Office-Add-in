{"version":3,"file":"commands.js","mappings":"YAwDA,SAASA,EAAmBC,GAC1B,IAAMC,EAAO,GAAHC,OAAMC,OAAOC,SAASC,OAAM,uBAChCC,EAAUC,mBAAmBC,KAAKC,UAAUT,IAC5CU,EAAM,GAAHR,OAAMD,EAAI,cAAAC,OAAaI,GAEhCK,OAAOC,QAAQC,GAAGC,mBAChBJ,EACA,CAAEK,OAAQ,GAAIC,MAAO,GAAIC,iBAAiB,GAC1C,WAAO,EAEX,CAhEAN,OAAOO,QAAQ,WAAO,GAmEA,oBAAXf,SACTA,OAAOgB,iBA9DT,SAA0BC,GAUjB,IAAIC,QAAQ,SAACC,EAASC,GAC3B,IAAMC,EAAUb,OAAOC,SAAWD,OAAOC,QAAQY,QAC5CA,EAMwC,mBAAlCA,EAAQC,sBAqBfD,EAAQE,MAAQF,EAAQE,KAAKC,QAC/BL,EAAQ,CAACE,EAAQE,KAAKC,UAIxBL,EAAQ,CAAC,2BAzBPE,EAAQC,sBAAsB,SAACG,GAC7B,GAAIA,EAAOC,SAAWlB,OAAOmB,kBAAkBC,UAA/C,CAIA,IACM/B,GADQgC,MAAMC,QAAQL,EAAOM,OAASN,EAAOM,MAAQ,IACpCC,IAAI,SAACC,GAAC,OAAKA,GAAKA,EAAET,OAAO,GAAEU,OAAOC,SAGjC,IAApBtC,EAASuC,QAAgBf,EAAQE,MAAQF,EAAQE,KAAKC,QACxDL,EAAQ,CAACE,EAAQE,KAAKC,UAIxBL,EAAQtB,EAASuC,OAASvC,EAAW,CAAC,0BAVtC,MAFEuB,EAAOK,EAAOY,OAAS,IAAIC,MAAM,iCAarC,GArBAlB,EAAO,IAAIkB,MAAM,kCAgCrB,GA3CGC,KAAK,SAAC1C,GAAQ,OAAKD,EAAmBC,EAAS,GAC/C2C,MAAM,SAACC,GAAG,OACT7C,EAAmB,CAAC,UAADG,OAAW0C,GAAOA,EAAIC,QAAUD,EAAIC,QAAUC,OAAOF,KAAQ,GAEjFG,QAAQ,kBAAM3B,EAAM4B,WAAW,EACpC,E","sources":["webpack://office-addin-taskpane-js/./src/commands/commands.js"],"sourcesContent":["/* global Office, window */\n\nOffice.onReady(() => {});\n\n/**\n * Called via ExecuteFunction from the manifest.\n * Shows a dialog listing subject(s) of the selected email(s).\n */\nfunction showSubjectPopup(event) {\n  getSelectedSubjects()\n    .then((subjects) => openSubjectsDialog(subjects))\n    .catch((err) =>\n      openSubjectsDialog([`Error: ${err && err.message ? err.message : String(err)}`])\n    )\n    .finally(() => event.completed());\n}\n\nfunction getSelectedSubjects() {\n  return new Promise((resolve, reject) => {\n    const mailbox = Office.context && Office.context.mailbox;\n    if (!mailbox) {\n      reject(new Error(\"Mailbox context not available.\"));\n      return;\n    }\n\n    // Preferred: multi-select (Mailbox 1.13+)\n    if (typeof mailbox.getSelectedItemsAsync === \"function\") {\n      mailbox.getSelectedItemsAsync((result) => {\n        if (result.status !== Office.AsyncResultStatus.Succeeded) {\n          reject(result.error || new Error(\"getSelectedItemsAsync failed.\"));\n          return;\n        }\n        const items = Array.isArray(result.value) ? result.value : [];\n        const subjects = items.map((i) => i && i.subject).filter(Boolean);\n\n        // Fallback: current item subject\n        if (subjects.length === 0 && mailbox.item && mailbox.item.subject) {\n          resolve([mailbox.item.subject]);\n          return;\n        }\n\n        resolve(subjects.length ? subjects : [\"(No subject available)\"]);\n      });\n      return;\n    }\n\n    // Fallback for clients without multi-select\n    if (mailbox.item && mailbox.item.subject) {\n      resolve([mailbox.item.subject]);\n      return;\n    }\n\n    resolve([\"(No subject available)\"]);\n  });\n}\n\nfunction openSubjectsDialog(subjects) {\n  const base = `${window.location.origin}/dialog/dialog.html`;\n  const payload = encodeURIComponent(JSON.stringify(subjects));\n  const url = `${base}?subjects=${payload}`;\n\n  Office.context.ui.displayDialogAsync(\n    url,\n    { height: 35, width: 30, displayInIframe: true },\n    () => {}\n  );\n}\n\n// Expose for Office to call\nif (typeof window !== \"undefined\") {\n  window.showSubjectPopup = showSubjectPopup;\n}\n"],"names":["openSubjectsDialog","subjects","base","concat","window","location","origin","payload","encodeURIComponent","JSON","stringify","url","Office","context","ui","displayDialogAsync","height","width","displayInIframe","onReady","showSubjectPopup","event","Promise","resolve","reject","mailbox","getSelectedItemsAsync","item","subject","result","status","AsyncResultStatus","Succeeded","Array","isArray","value","map","i","filter","Boolean","length","error","Error","then","catch","err","message","String","finally","completed"],"ignoreList":[],"sourceRoot":""}