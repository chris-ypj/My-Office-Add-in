{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js"],"sourcesContent":["/* global Office, document, console, localStorage */\n\nconst ATTR_KEY = \"inboxAgent.attributes\";\nconst LOCAL_ATTR_KEY = \"inboxAgent.local.\";\nconst NOTIFICATION_ID = \"AportioAttributes\";\nconst CATEGORY_OPTIONS = [\"Product\", \"Support\", \"Sales\", \"Billing\"];\nconst PRIORITY_OPTIONS = [\"Low\", \"Normal\", \"High\"];\nconst DEFAULT_SENTIMENT_OPTIONS = [\"Negative\", \"Neutral\", \"Positive\"];\nconst NOTIFICATION_ICON = \"icon16\";\nconst API_BASE_URL = \"https://attorney-healthy-weddings-attacked.trycloudflare.com\";\nconst ANALYZE_URL = \"https://attorney-healthy-weddings-attacked.trycloudflare.com/analyze\";\nconst API_KEY = \"24324ddadasadasdasdawqeqwewewqqwewqzx\";\nconst REPORTS_ENDPOINT = \"/status\";\n//mock backend\nconst DEFAULT_REPORTS_BASE_URL =\n  \"https://attorney-healthy-weddings-attacked.trycloudflare.com\";\nconst REPORTS_BEARER_TOKEN = process.env.REPORTS_BEARER_TOKEN || \"\";\nconst INBOXAGENT_BASE_URL = \"https://alignment-usage-prescribed-airline.trycloudflare.com\";\nconst INBOXAGENT_CUSTOMER_ID = \"K7BE\";\nconst INBOXAGENT_API_KEY_ID = process.env.INBOXAGENT_API_KEY_ID || \"\";\nconst INBOXAGENT_API_KEY_SECRET = process.env.INBOXAGENT_API_KEY_SECRET || \"\";\nconst TEMPLATE_HTML = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n  <title></title>\n  <style>\n    body, p {font-family: Arial, Helvetica, sans-serif;}\n  </style>\n</head>\n<body>\n  {{content}}\n</body>\n</html>`;\n\nfunction getItem() {\n  return Office.context?.mailbox?.item;\n}\n\nfunction isComposeItem(item) {\n  return Boolean(item?.body?.setAsync);\n}\n\nfunction updateStatus(text) {\n  const status = document.getElementById(\"statusText\");\n  if (status) {\n    status.textContent = text;\n  }\n}\n\nfunction setAnalysisSummary(text) {\n  const summary = document.getElementById(\"summary\");\n  if (summary) {\n    summary.textContent = text;\n  }\n}\n\nfunction setSuggestedActions(actions) {\n  const container = document.getElementById(\"suggestedActions\");\n  if (!container) return;\n  container.innerHTML = \"\";\n  if (!actions || actions.length === 0) {\n    container.textContent = \"No suggested actions.\";\n    return;\n  }\n  actions.forEach((action) => {\n    const chip = document.createElement(\"span\");\n    chip.className = \"chip\";\n    chip.textContent = action;\n    container.appendChild(chip);\n  });\n}\n\nfunction setSuggestedActionsStatus(text) {\n  const container = document.getElementById(\"suggestedActions\");\n  if (container) {\n    container.textContent = text;\n  }\n}\n\nfunction normalizeSuggestedActions(value) {\n  if (!value) return [];\n  if (Array.isArray(value)) {\n    return value.map((entry) => String(entry)).filter(Boolean);\n  }\n  if (typeof value === \"string\") {\n    return value\n      .split(/[,;]\\s*/g)\n      .map((entry) => entry.trim())\n      .filter(Boolean);\n  }\n  return [];\n}\n\nfunction setFormValues(attrs) {\n  const { category, sentiment, priority, assignee } = attrs || {};\n  if (category !== undefined) document.getElementById(\"category\").value = category || \"\";\n  if (sentiment !== undefined) document.getElementById(\"sentiment\").value = sentiment || \"\";\n  if (priority !== undefined) document.getElementById(\"priority\").value = priority || \"\";\n  if (assignee !== undefined) document.getElementById(\"assignee\").value = assignee || \"\";\n}\n\nfunction normalizeSelectValue(selectId, value) {\n  if (!value) return \"\";\n  const select = document.getElementById(selectId);\n  if (!select) return value;\n  const lower = String(value).toLowerCase();\n  const match = Array.from(select.options).find(\n    (opt) => String(opt.value).toLowerCase() === lower\n  );\n  return match ? match.value : value;\n}\n\nfunction ensureSelectOption(selectId, value) {\n  if (!value) return;\n  const select = document.getElementById(selectId);\n  if (!select) return;\n  const exists = Array.from(select.options).some((opt) => opt.value === value);\n  if (!exists) {\n    const option = document.createElement(\"option\");\n    option.value = value;\n    option.textContent = value;\n    select.appendChild(option);\n  }\n}\n\nfunction applyAnalysisToForm(data) {\n  const category = normalizeSelectValue(\"category\", data.category || \"\");\n  const sentiment = normalizeSelectValue(\"sentiment\", data.sentiment || \"\");\n  const priority = normalizeSelectValue(\"priority\", data.priority || \"\");\n  const assignee = data.assignee || \"\";\n\n  ensureSelectOption(\"category\", category);\n  ensureSelectOption(\"sentiment\", sentiment);\n  ensureSelectOption(\"priority\", priority);\n\n  setFormValues({ category, sentiment, priority, assignee });\n}\n\nfunction readFormValues() {\n  return {\n    category: document.getElementById(\"category\").value,\n    sentiment: document.getElementById(\"sentiment\").value,\n    priority: document.getElementById(\"priority\").value,\n    assignee: document.getElementById(\"assignee\").value.trim(),\n  };\n}\n\nfunction buildSummary(attrs) {\n  const parts = [];\n  if (attrs.category) parts.push(`Category: ${attrs.category}`);\n  if (attrs.sentiment) parts.push(`Sentiment: ${attrs.sentiment}`);\n  if (attrs.priority) parts.push(`Priority: ${attrs.priority}`);\n  if (attrs.assignee) parts.push(`Assignee: ${attrs.assignee}`);\n  return parts.length ? parts.join(\" | \") : \"No attributes set\";\n}\n\nfunction escapeHtml(value) {\n  return String(value || \"\")\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#39;\");\n}\n\nfunction renderTemplate(attrs) {\n  const summary = buildSummary(attrs);\n  const includeSummary = summary !== \"No attributes set\";\n  const summaryBlock = includeSummary ? `<p>${escapeHtml(summary)}</p>` : \"\";\n  const content = `<p>Hi</p><p>This is a template reply.</p>${summaryBlock}<p>Thanks</p>`;\n  return TEMPLATE_HTML.replace(\"{{content}}\", content).replace(\"{{footer}}\", \"\");\n}\n\nfunction renderTemplateById(templateId, attrs) {\n  if (templateId === \"processing\") {\n    const summary = buildSummary(attrs);\n    const includeSummary = summary !== \"No attributes set\";\n    const summaryBlock = includeSummary ? `<p>${escapeHtml(summary)}</p>` : \"\";\n    const content = `<p>Hi</p><p>I am working on this and will reply within 3 business days.</p>${summaryBlock}<p>Thanks</p>`;\n    return TEMPLATE_HTML.replace(\"{{content}}\", content).replace(\"{{footer}}\", \"\");\n  }\n\n  return renderTemplate(attrs);\n}\n\nfunction getLocalKey() {\n  const item = getItem();\n  if (item?.itemId) {\n    return `${LOCAL_ATTR_KEY}${item.itemId}`;\n  }\n  return null;\n}\n\nfunction saveLocalAttributes(attrs) {\n  const key = getLocalKey();\n  if (key) {\n    localStorage.setItem(key, JSON.stringify(attrs));\n  }\n}\n\nfunction loadLocalAttributes() {\n  const key = getLocalKey();\n  if (!key) return null;\n  const raw = localStorage.getItem(key);\n  if (!raw) return null;\n  try {\n    return JSON.parse(raw);\n  } catch {\n    return null;\n  }\n}\n\nfunction clearLocalAttributes() {\n  const key = getLocalKey();\n  if (key) {\n    localStorage.removeItem(key);\n  }\n}\n\nfunction withCustomProperties(handler) {\n  return new Promise((resolve, reject) => {\n    const item = getItem();\n    if (!item) {\n      reject(new Error(\"Mailbox item is not available.\"));\n      return;\n    }\n\n    item.loadCustomPropertiesAsync((result) => {\n      if (result.status !== Office.AsyncResultStatus.Succeeded) {\n        reject(result.error || new Error(\"Unable to load custom properties.\"));\n        return;\n      }\n\n      handler(result.value, resolve, reject);\n    });\n  });\n}\n\nfunction loadAttributes() {\n  return withCustomProperties((props, resolve, reject) => {\n    try {\n      const raw = props.get(ATTR_KEY);\n      if (!raw) {\n        resolve(null);\n        return;\n      }\n      resolve(JSON.parse(raw));\n    } catch (err) {\n      reject(err);\n    }\n  });\n}\n\nfunction saveAttributes(attrs) {\n  return withCustomProperties((props, resolve, reject) => {\n    props.set(ATTR_KEY, JSON.stringify(attrs));\n    props.saveAsync((result) => {\n      if (result.status === Office.AsyncResultStatus.Succeeded) {\n        resolve();\n        return;\n      }\n      reject(result.error || new Error(\"Unable to save attributes.\"));\n    });\n  });\n}\n\nfunction clearAttributes() {\n  return withCustomProperties((props, resolve, reject) => {\n    try {\n      if (typeof props.remove === \"function\") {\n        props.remove(ATTR_KEY);\n      } else {\n        props.set(ATTR_KEY, \"null\");\n      }\n      props.saveAsync((result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve();\n          return;\n        }\n        reject(result.error || new Error(\"Unable to clear attributes.\"));\n      });\n    } catch (err) {\n      reject(err);\n    }\n  });\n}\n\nfunction pushNotification(message, type = \"informationalMessage\") {\n  return new Promise((resolve) => {\n    const item = getItem();\n    if (!item?.notificationMessages?.replaceAsync) {\n      resolve();\n      return;\n    }\n\n    const details = { type, message };\n    if (type === \"informationalMessage\") {\n      details.icon = NOTIFICATION_ICON;\n      details.persistent = true;\n    }\n\n    try {\n      item.notificationMessages.replaceAsync(NOTIFICATION_ID, details, () => resolve());\n    } catch (e) {\n      console.warn(\"Notification not shown (ignored):\", e);\n      resolve();\n    }\n  });\n}\n\nfunction setSelectOptions(select, options) {\n  if (!select) {\n    return;\n  }\n  const placeholder = select.querySelector('option[value=\"\"]');\n  select.innerHTML = \"\";\n  if (placeholder) {\n    select.appendChild(placeholder);\n  } else {\n    const blank = document.createElement(\"option\");\n    blank.value = \"\";\n    blank.textContent = \"—\";\n    select.appendChild(blank);\n  }\n  options.forEach((option) => {\n    const opt = document.createElement(\"option\");\n    opt.value = option;\n    opt.textContent = option;\n    select.appendChild(opt);\n  });\n}\n\nfunction setSelectOptionsWithValue(select, options) {\n  if (!select) {\n    return;\n  }\n  const placeholder = select.querySelector('option[value=\"\"]');\n  select.innerHTML = \"\";\n  if (placeholder) {\n    select.appendChild(placeholder);\n  } else {\n    const blank = document.createElement(\"option\");\n    blank.value = \"\";\n    blank.textContent = \"—\";\n    select.appendChild(blank);\n  }\n  options.forEach((option) => {\n    const opt = document.createElement(\"option\");\n    opt.value = option.value;\n    opt.textContent = option.label;\n    select.appendChild(opt);\n  });\n}\n\nfunction getReportsFormValues() {\n  const baseUrl = DEFAULT_REPORTS_BASE_URL;\n  const token = REPORTS_BEARER_TOKEN;\n  return { baseUrl, token };\n}\n\nfunction buildReportsUrl(baseUrl) {\n  if (!baseUrl) return \"\";\n  return `${baseUrl.replace(/\\/+$/, \"\")}${REPORTS_ENDPOINT}`;\n}\n\n\nfunction formatReportLabel(item, index) {\n  const subject = item?.subject || item?.email_subject || item?.title || item?.name;\n  const id = item?.id || item?.pk || item?.uuid;\n  if (subject && id) return `${subject} (#${id})`;\n  if (subject) return subject;\n  if (id) return `Report ${id}`;\n  return `Report ${index + 1}`;\n}\n\nfunction normalizeReportItems(payload) {\n  if (Array.isArray(payload?.data?.reporter)) return payload.data.reporter;\n  return [];\n}\n\nfunction setLatestEmailSummary(text) {\n  const el = document.getElementById(\"latestEmailSummary\");\n  if (!el) return;\n  el.textContent = text || \"—\";\n}\n\nfunction formatEmailFrom(value) {\n  if (!value) return \"\";\n  if (typeof value === \"string\") return value;\n  const name = value.name || value.display_name || value.full_name || \"\";\n  const email = value.email || value.address || value.email_address || \"\";\n  if (name && email) return `${name} <${email}>`;\n  return name || email || \"\";\n}\n\nfunction formatEmailDate(value) {\n  if (!value) return \"\";\n  const date = new Date(value);\n  if (!Number.isNaN(date.getTime())) {\n    return date.toLocaleString();\n  }\n  return String(value);\n}\n\nfunction formatEmailSummary(item) {\n  if (!item) return \"—\";\n  const subject = item?.subject || item?.email_subject || item?.title || \"\";\n  const from = formatEmailFrom(item?.from || item?.from_address || item?.sender || item?.email_from);\n  const date = formatEmailDate(item?.date || item?.sent_at || item?.created_at || item?.received_at);\n  const parts = [];\n  if (subject) parts.push(subject);\n  if (from) parts.push(`from ${from}`);\n  if (date) parts.push(date);\n  return parts.length ? parts.join(\" · \") : \"—\";\n}\n\nfunction getFromAddress(item) {\n  const from = item?.from;\n  return normalizeEmailAddress(from);\n}\n\nfunction getMessageId(item) {\n  const raw = item?.internetMessageId || item?.messageId || \"\";\n  return String(raw || \"\");\n}\n\nfunction getDateSent(item) {\n  const candidate = item?.dateTimeSent || item?.dateTimeCreated || new Date().toISOString();\n  try {\n    return new Date(candidate).toISOString();\n  } catch {\n    return new Date().toISOString();\n  }\n}\n\nasync function loadReportEmails() {\n  const select = document.getElementById(\"reportEmailsSelect\");\n  if (select) {\n    setSelectOptionsWithValue(select, []);\n  }\n\n  const { baseUrl, token } = getReportsFormValues();\n  if (!baseUrl || !token) {\n    updateStatus(\"reports: base url and token required\");\n    return;\n  }\n\n  updateStatus(\"reports: loading...\");\n\n  const url = buildReportsUrl(baseUrl);\n  try {\n    const response = await fetch(url, {\n      headers: {\n        Accept: \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    if (!response.ok) {\n      updateStatus(`reports: request failed (${response.status})`);\n      return;\n    }\n\n    const data = await response.json();\n    const items = normalizeReportItems(data);\n    const options = items.map((item, index) => {\n      const id = String(index + 1);\n      return {\n        value: String(id),\n        label: String(item),\n      };\n    });\n    if (select) {\n      setSelectOptionsWithValue(select, options);\n    }\n    updateStatus(`reports: loaded ${items.length}`);\n  } catch (err) {\n    console.error(\"Report fetch failed\", err);\n    updateStatus(\"reports: request error\");\n  }\n}\n\nfunction updateItemCategories(selected, managed) {\n  return new Promise((resolve, reject) => {\n    const item = getItem();\n    if (!item?.categories?.getAsync) {\n      resolve();\n      return;\n    }\n\n    item.categories.getAsync((result) => {\n      if (result.status !== Office.AsyncResultStatus.Succeeded) {\n        reject(result.error || new Error(\"Unable to read categories.\"));\n        return;\n      }\n\n      const normalizeCategory = (name) => String(name || \"\").trim().toLowerCase();\n      const current = (result.value || []).map((name) => String(name || \"\"));\n      const selectedSet = new Set(selected.filter(Boolean).map(normalizeCategory));\n      const managedSet = new Set(managed.map(normalizeCategory));\n      const remaining = current.filter((name) => {\n        const normalized = normalizeCategory(name);\n        if (!managedSet.has(normalized)) {\n          return true;\n        }\n        return selectedSet.has(normalized);\n      });\n      const toRemove = current.filter(\n        (name) => managedSet.has(normalizeCategory(name)) && !selectedSet.has(normalizeCategory(name))\n      );\n      const toAdd = selected.filter(\n        (name) =>\n          name &&\n          !current.some((existing) => normalizeCategory(existing) === normalizeCategory(name))\n      );\n\n      const finish = () => resolve();\n      const addCategories = () => {\n        if (!toAdd.length) {\n          finish();\n          return;\n        }\n        item.categories.addAsync(toAdd, (addResult) => {\n          if (addResult.status !== Office.AsyncResultStatus.Succeeded) {\n            reject(addResult.error || new Error(\"Unable to add category.\"));\n            return;\n          }\n          finish();\n        });\n      };\n\n      if (!toRemove.length) {\n        addCategories();\n        return;\n      }\n\n      const removeThenAdd = () => {\n        item.categories.removeAsync(toRemove, (removeResult) => {\n          if (removeResult.status !== Office.AsyncResultStatus.Succeeded) {\n            reject(removeResult.error || new Error(\"Unable to remove categories.\"));\n            return;\n          }\n          addCategories();\n        });\n      };\n\n      if (typeof item.categories.setAsync === \"function\") {\n        item.categories.setAsync(remaining, (setResult) => {\n          if (setResult.status === Office.AsyncResultStatus.Succeeded) {\n            resolve();\n            return;\n          }\n          // Fallback for hosts that report setAsync but do not allow it.\n          removeThenAdd();\n        });\n        return;\n      }\n\n      removeThenAdd();\n    });\n  });\n}\n\nfunction clearAllCategories() {\n  return new Promise((resolve, reject) => {\n    const item = getItem();\n    if (!item?.categories?.getAsync) {\n      resolve();\n      return;\n    }\n\n    item.categories.getAsync((result) => {\n      if (result.status !== Office.AsyncResultStatus.Succeeded) {\n        reject(result.error || new Error(\"Unable to read categories.\"));\n        return;\n      }\n\n      const current = (result.value || [])\n        .map((name) => String(name || \"\").trim())\n        .filter(Boolean);\n      if (!current.length) {\n        resolve();\n        return;\n      }\n\n      item.categories.removeAsync(current, (removeResult) => {\n        if (removeResult.status === Office.AsyncResultStatus.Succeeded) {\n          resolve();\n          return;\n        }\n\n        if (typeof item.categories.setAsync === \"function\") {\n          item.categories.setAsync([], (setResult) => {\n            if (setResult.status === Office.AsyncResultStatus.Succeeded) {\n              resolve();\n              return;\n            }\n            reject(setResult.error || new Error(\"Unable to clear categories.\"));\n          });\n          return;\n        }\n\n        reject(removeResult.error || new Error(\"Unable to clear categories.\"));\n      });\n    });\n  });\n}\n\nfunction updateItemImportance(priority) {\n  return new Promise((resolve, reject) => {\n    const item = getItem();\n    if (!isComposeItem(item)) {\n      resolve();\n      return;\n    }\n    if (!item?.importance?.setAsync) {\n      resolve();\n      return;\n    }\n\n    const value = priority ? priority.toLowerCase() : \"normal\";\n    item.importance.setAsync(value, (result) => {\n      if (result.status === Office.AsyncResultStatus.Succeeded) {\n        resolve();\n        return;\n      }\n      reject(result.error || new Error(\"Unable to set importance.\"));\n    });\n  });\n}\n\nfunction isUnsupportedHostError(err) {\n  if (!err) return false;\n  const message = String(err.message || \"\").toLowerCase();\n  return err.code === 5000 || message.includes(\"not supported\");\n}\n\nfunction clearNotification() {\n  return new Promise((resolve) => {\n    const item = getItem();\n    if (!item?.notificationMessages) {\n      resolve();\n      return;\n    }\n    const notifications = item.notificationMessages;\n    const fallbackReplace = () => {\n      if (typeof notifications.replaceAsync !== \"function\") {\n        resolve();\n        return;\n      }\n      try {\n        notifications.replaceAsync(\n          NOTIFICATION_ID,\n          { type: \"informationalMessage\", message: \"\" },\n          () => resolve()\n        );\n      } catch (err) {\n        console.warn(\"Notification clear fallback failed (ignored):\", err);\n        resolve();\n      }\n    };\n    if (typeof notifications.removeAsync === \"function\") {\n      notifications.removeAsync(NOTIFICATION_ID, (result) => {\n        if (result?.status === Office.AsyncResultStatus.Succeeded) {\n          resolve();\n          return;\n        }\n        fallbackReplace();\n      });\n      return;\n    }\n    fallbackReplace();\n  });\n}\n\nasync function hydrateForm(options = {}) {\n  const { preserveForm = false, allowLocalFallback = true, notify = true } = options;\n  const item = getItem();\n  if (item?.subject) {\n    setAnalysisSummary(`Analyzing: ${item.subject}`);\n  } else {\n    setAnalysisSummary(\"Analyzing...\");\n  }\n  setSuggestedActionsStatus(\"Analyzing...\");\n  runAiAnalysis();\n\n  try {\n    const sentimentSelect = document.getElementById(\"sentiment\");\n    setSelectOptions(sentimentSelect, DEFAULT_SENTIMENT_OPTIONS);\n\n    updateStatus(\"loading saved attributes...\");\n    let attrs = await loadAttributes();\n    if (!attrs && allowLocalFallback) {\n      attrs = loadLocalAttributes();\n      if (attrs) {\n        updateStatus(\"loaded local attributes\");\n        if (notify) {\n          await pushNotification(`Restored local attributes • ${buildSummary(attrs)}`);\n        }\n      }\n    }\n    if (attrs) {\n      if (!preserveForm) {\n        setFormValues(attrs);\n      }\n      updateStatus(\"loaded saved attributes\");\n      if (notify) {\n        await pushNotification(`Restored attributes • ${buildSummary(attrs)}`);\n      }\n    } else {\n      updateStatus(\"ready\");\n    }\n  } catch (err) {\n    console.error(\"Failed to load saved attributes\", err);\n    updateStatus(\"ready (attributes not loaded)\");\n  }\n}\n\nasync function handleApply() {\n  const attrs = readFormValues();\n  updateStatus(\"applying attributes...\");\n\n  try {\n    let savedToMailbox = true;\n    try {\n      await saveAttributes(attrs);\n    } catch (err) {\n      if (isUnsupportedHostError(err)) {\n        savedToMailbox = false;\n      } else {\n        throw err;\n      }\n    }\n    const selectedCategories = [];\n    if (attrs.category) selectedCategories.push(attrs.category);\n    const managedCategories = CATEGORY_OPTIONS;\n    try {\n      await updateItemCategories(selectedCategories, managedCategories);\n    } catch (err) {\n      if (!isUnsupportedHostError(err)) {\n        throw err;\n      }\n    }\n    try {\n      await updateItemImportance(attrs.priority);\n    } catch (err) {\n      console.warn(\"Failed to set importance.\", err);\n      await pushNotification(\n        \"Priority not updated in Outlook (importance update failed).\",\n        \"errorMessage\"\n      );\n    }\n    saveLocalAttributes(attrs);\n    const summary = buildSummary(attrs);\n    updateStatus(\n      savedToMailbox\n        ? \"attributes saved to this item\"\n        : \"attributes saved locally (mailbox properties not supported)\"\n    );\n    await pushNotification(`Aportio saved • ${summary}`);\n  } catch (err) {\n    console.error(\"Failed to apply attributes\", err);\n    saveLocalAttributes(attrs);\n    const errorText = err && err.message ? err.message : String(err);\n    updateStatus(\"saved locally (server save failed)\");\n    await pushNotification(\n      `Saved locally only (could not save to mailbox): ${errorText}`,\n      \"errorMessage\"\n    );\n  }\n}\n\nasync function handleClear() {\n  updateStatus(\"clearing attributes...\");\n  const errors = [];\n  const recordError = (label, err) => {\n    errors.push(label);\n    console.error(`Failed to clear ${label}`, err);\n  };\n\n  try {\n    await clearAttributes();\n  } catch (err) {\n    recordError(\"stored attributes\", err);\n  }\n\n  try {\n    clearLocalAttributes();\n  } catch (err) {\n    recordError(\"local attributes\", err);\n  }\n\n  try {\n    await clearAllCategories();\n  } catch (err) {\n    recordError(\"categories\", err);\n  }\n\n  try {\n    await updateItemImportance(\"\");\n  } catch (err) {\n    recordError(\"importance\", err);\n  }\n\n  setFormValues({\n    category: \"\",\n    sentiment: \"\",\n    priority: \"\",\n    assignee: \"\",\n  });\n  await clearNotification();\n\n  if (errors.length) {\n    updateStatus(`clear done (failed: ${errors.join(\", \")})`);\n  } else {\n    updateStatus(\"attributes cleared\");\n  }\n}\n\nfunction handleSnooze() {\n  updateStatus(\"snoozed (demo)\");\n}\n\nfunction handleQuickAction(text) {\n  updateStatus(text);\n}\n\nfunction getItemBodyText() {\n  return new Promise((resolve) => {\n    const item = getItem();\n    if (!item?.body?.getAsync) {\n      resolve(\"\");\n      return;\n    }\n    item.body.getAsync(Office.CoercionType.Text, (result) => {\n      if (result.status === Office.AsyncResultStatus.Succeeded) {\n        resolve(result.value || \"\");\n        return;\n      }\n      resolve(\"\");\n    });\n  });\n}\n\n\nfunction getItemBodyHtml() {\n  return new Promise((resolve) => {\n    const item = getItem();\n    if (!item?.body?.getAsync) {\n      resolve(\"\");\n      return;\n    }\n    item.body.getAsync(Office.CoercionType.Html, (result) => {\n      if (result.status === Office.AsyncResultStatus.Succeeded) {\n        resolve(result.value || \"\");\n        return;\n      }\n      resolve(\"\");\n    });\n  });\n}\n\nfunction buildInboxagentUrl(path) {\n  return `${INBOXAGENT_BASE_URL.replace(/\\/+$/, \"\")}${path}`;\n}\n\nfunction buildBasicAuthHeader(id, secret) {\n  if (!id || !secret) return \"\";\n  return `Basic ${btoa(`${id}:${secret}`)}`;\n}\n\nfunction normalizeEmailAddress(entry) {\n  if (!entry) return \"\";\n  if (typeof entry === \"string\") return entry;\n  return entry.emailAddress || entry.address || entry.name || \"\";\n}\n\nfunction joinEmailAddresses(entries) {\n  if (!entries) return \"\";\n  return entries\n    .map((entry) => normalizeEmailAddress(entry))\n    .map((value) => String(value || \"\").trim())\n    .filter(Boolean)\n    .join(\", \");\n}\n\nfunction readRecipientsAsync(item, field) {\n  return new Promise((resolve) => {\n    const value = item?.[field];\n    if (!value) {\n      resolve(\"\");\n      return;\n    }\n    if (Array.isArray(value)) {\n      resolve(joinEmailAddresses(value));\n      return;\n    }\n    if (typeof value.getAsync === \"function\") {\n      value.getAsync((result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(joinEmailAddresses(result.value || []));\n          return;\n        }\n        resolve(\"\");\n      });\n      return;\n    }\n    resolve(\"\");\n  });\n}\n\nasync function getEmails() {\n  if (!INBOXAGENT_BASE_URL || !INBOXAGENT_CUSTOMER_ID) {\n    updateStatus(\"emails: base url or customer id missing\");\n    return;\n  }\n  const authHeader = buildBasicAuthHeader(INBOXAGENT_API_KEY_ID, INBOXAGENT_API_KEY_SECRET);\n  if (!authHeader) {\n    updateStatus(\"emails: API key missing\");\n    return;\n  }\n\n  updateStatus(\"emails: fetching...\");\n\n  try {\n    const response = await fetch(\n      \"https://alignment-usage-prescribed-airline.trycloudflare.com/api/v2/reports/report_emails/?limit=50&offset=0&ordering=desc\",\n      {\n        method: \"GET\",\n        headers: {\n          Authorization: authHeader,\n        },\n      }\n    );\n\n    if (!response.ok) {\n      updateStatus(`emails failed (${response.status})`);\n      return;\n    }\n\n    const data = await response.json();\n    const count = Array.isArray(data?.results) ? data.results.length : \"\";\n    const latest = Array.isArray(data?.results) ? data.results[0] : null;\n    setLatestEmailSummary(formatEmailSummary(latest));\n    updateStatus(count ? `emails ok (fetched: ${count})` : \"emails ok\");\n    await pushNotification(\"Emails fetched\", \"informationalMessage\");\n  } catch (err) {\n    console.error(\"Email fetch failed\", err);\n    setLatestEmailSummary(\"—\");\n    updateStatus(\"emails failed (network error)\");\n  }\n}\n\nasync function syncToInboxagent() {\n  const item = getItem();\n  if (!item) {\n    updateStatus(\"sync: no item selected\");\n    return;\n  }\n  if (!INBOXAGENT_BASE_URL || !INBOXAGENT_CUSTOMER_ID) {\n    updateStatus(\"sync: base url or customer id missing\");\n    return;\n  }\n  const authHeader = buildBasicAuthHeader(INBOXAGENT_API_KEY_ID, INBOXAGENT_API_KEY_SECRET);\n  if (!authHeader) {\n    updateStatus(\"sync: API key missing\");\n    return;\n  }\n\n  updateStatus(\"sync: sending to InboxAgent...\");\n\n  const [plain, html, to, cc] = await Promise.all([\n    getItemBodyText(),\n    getItemBodyHtml(),\n    readRecipientsAsync(item, \"to\"),\n    readRecipientsAsync(item, \"cc\"),\n  ]);\n\n  const payload = {\n    plain,\n    html,\n    headers: {\n      date: getDateSent(item),\n      from: getFromAddress(item),\n      to,\n      cc,\n      subject: item.subject || \"\",\n      message_id: getMessageId(item),\n    },\n  };\n\n  try {\n    const response = await fetch(\n      buildInboxagentUrl(`/api/v4/features/email/${encodeURIComponent(INBOXAGENT_CUSTOMER_ID)}/classify/`),\n      {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: authHeader,\n        },\n        body: JSON.stringify(payload),\n      }\n    );\n\n    if (!response.ok) {\n      updateStatus(`sync failed (${response.status})`);\n      return;\n    }\n\n    const data = await response.json();\n    const requestId = data?.id || data?.metadata?.request_id || \"\";\n    updateStatus(requestId ? `sync ok (id: ${requestId})` : \"sync ok\");\n    await pushNotification(\"InboxAgent synced\", \"informationalMessage\");\n  } catch (err) {\n    console.error(\"InboxAgent sync failed\", err);\n    updateStatus(\"sync failed (network error)\");\n  }\n}\n\nasync function runAiAnalysis(options = {}) {\n  const { applyToForm = false } = options;\n  const item = getItem();\n  if (!item) {\n    setAnalysisSummary(\"AI analysis not available.\");\n    setSuggestedActions([]);\n    return;\n  }\n\n  setAnalysisSummary(\"Analyzing...\");\n  setSuggestedActionsStatus(\"Analyzing...\");\n\n  const subject = item.subject || \"\";\n  const body = await getItemBodyText();\n\n  try {\n    const response = await fetch(ANALYZE_URL, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ subject, body, api_key: API_KEY }),\n    });\n    if (!response.ok) {\n      throw new Error(`Analyze request failed (${response.status})`);\n    }\n\n    const data = await response.json();\n    const summaryText =\n      data.rationale ||\n      data.reply_suggestion ||\n      \"No analysis returned.\";\n    const suggestedActions = normalizeSuggestedActions(\n      data.actions && Array.isArray(data.actions) && data.actions.length\n        ? data.actions\n        : data.reply_suggestion\n    );\n\n    setAnalysisSummary(summaryText);\n    setSuggestedActions(suggestedActions);\n\n    if (applyToForm) {\n      applyAnalysisToForm(data);\n      updateStatus(\"analysis applied to attributes\");\n    }\n  } catch (err) {\n    console.error(\"AI analysis failed\", err);\n    setAnalysisSummary(\"AI analysis failed.\");\n    setSuggestedActions([]);\n  }\n}\n\nasync function handleAiReply() {\n  const item = getItem();\n  if (!item) {\n    updateStatus(\"ai reply not available\");\n    return;\n  }\n\n  updateStatus(\"generating ai reply...\");\n  const subject = item.subject || \"\";\n  const body = await getItemBodyText();\n\n  try {\n    const response = await fetch(`${API_BASE_URL}/reply`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        subject,\n        body,\n        tone: \"professional\",\n        api_key: API_KEY,\n      }),\n    });\n    if (!response.ok) {\n      throw new Error(`Reply request failed (${response.status})`);\n    }\n    const data = await response.json();\n    const replyText = data.reply_text || \"\";\n    if (!replyText) {\n      throw new Error(\"Empty reply from server\");\n    }\n\n    if (item.body?.setAsync) {\n      const replyHtml = escapeHtml(replyText).replace(/\\n/g, \"<br>\");\n      item.body.setAsync(replyHtml, { coercionType: Office.CoercionType.Html }, (result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          updateStatus(\"ai reply inserted\");\n          return;\n        }\n        updateStatus(\"ai reply insert failed\");\n      });\n      return;\n    }\n\n    if (item.displayReplyForm) {\n      item.displayReplyForm(replyText);\n      updateStatus(\"ai reply draft opened\");\n      return;\n    }\n\n    updateStatus(\"ai reply not available\");\n  } catch (err) {\n    console.error(\"AI reply failed\", err);\n    updateStatus(\"ai reply failed\");\n  }\n}\n\nfunction handleInsertTemplate() {\n  const mailbox = Office.context?.mailbox;\n  const attrs = readFormValues();\n  const templateId = document.getElementById(\"templateSelect\")?.value || \"default\";\n  const html = renderTemplateById(templateId, attrs);\n\n  if (mailbox?.displayNewMessageForm) {\n    try {\n      mailbox.displayNewMessageForm({ htmlBody: html });\n      updateStatus(\"new email opened\");\n      return;\n    } catch (err) {\n      console.error(\"New email create failed\", err);\n      updateStatus(\"new email open failed\");\n      return;\n    }\n  }\n\n  const item = getItem();\n  if (!item?.body?.setAsync) {\n    updateStatus(\"template insert not available\");\n    return;\n  }\n\n  const itemClass = item.itemClass || \"\";\n  const shouldReplace =\n    Boolean(item.inReplyTo) || /reply|forward/i.test(itemClass);\n\n  const done = (result) => {\n    if (result?.status === Office.AsyncResultStatus.Succeeded) {\n      updateStatus(\"template inserted\");\n      return;\n    }\n    const err = result?.error || new Error(\"Unable to insert template.\");\n    console.error(\"Template insert failed\", err);\n    updateStatus(\"template insert failed\");\n  };\n\n  if (shouldReplace) {\n    item.body.setAsync(html, { coercionType: Office.CoercionType.Html }, done);\n    return;\n  }\n\n  if (!item.body.appendAsync) {\n    item.body.setAsync(html, { coercionType: Office.CoercionType.Html }, done);\n    return;\n  }\n\n  item.body.appendAsync(html, { coercionType: Office.CoercionType.Html }, done);\n}\n\nfunction handleReplyWithTemplate() {\n  const item = getItem();\n  if (!item?.displayReplyForm) {\n    updateStatus(\"reply with template not available\");\n    return;\n  }\n\n  const attrs = readFormValues();\n  const templateId = document.getElementById(\"templateSelect\")?.value || \"default\";\n  const html = renderTemplateById(templateId, attrs);\n  try {\n    item.displayReplyForm(html);\n    updateStatus(\"reply draft opened\");\n  } catch (err) {\n    console.error(\"Reply with template failed\", err);\n    updateStatus(\"reply template failed\");\n  }\n}\n\nOffice.onReady(() => {\n  hydrateForm();\n  loadReportEmails();\n\n  const bindClick = (id, handler) => {\n    const el = document.getElementById(id);\n    if (!el) {\n      return;\n    }\n    el.addEventListener(\"click\", handler);\n  };\n\n  bindClick(\"btnApply\", () => handleApply());\n  bindClick(\"btnSync\", () => syncToInboxagent());\n  bindClick(\"btnGetEmails\", () => getEmails());\n  bindClick(\"btnSnooze\", () => handleSnooze());\n  bindClick(\"btnRefresh\", () => {\n    hydrateForm({ preserveForm: true, allowLocalFallback: false, notify: true });\n  });\n  bindClick(\"btnClear\", () => handleClear());\n  bindClick(\"btnWorkflow\", () => handleQuickAction(\"workflow started (demo)\"));\n  bindClick(\"btnAnalyze\", () => runAiAnalysis({ applyToForm: true }));\n  bindClick(\"btnTemplate\", () => handleInsertTemplate());\n  bindClick(\"btnReplyTemplate\", () => handleReplyWithTemplate());\n  bindClick(\"btnReply\", () => handleAiReply());\n});\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","ATTR_KEY","NOTIFICATION_ID","CATEGORY_OPTIONS","DEFAULT_SENTIMENT_OPTIONS","API_KEY","INBOXAGENT_API_KEY_ID","process","INBOXAGENT_API_KEY_SECRET","TEMPLATE_HTML","getItem","_Office$context","Office","context","mailbox","item","updateStatus","text","status","document","getElementById","textContent","setAnalysisSummary","summary","setSuggestedActions","actions","container","innerHTML","forEach","action","chip","createElement","className","appendChild","setSuggestedActionsStatus","normalizeSuggestedActions","Array","isArray","map","entry","String","filter","Boolean","split","trim","setFormValues","attrs","_ref","category","sentiment","priority","assignee","undefined","normalizeSelectValue","selectId","select","lower","toLowerCase","match","from","options","find","opt","ensureSelectOption","some","option","applyAnalysisToForm","data","readFormValues","buildSummary","parts","push","concat","join","escapeHtml","replace","renderTemplateById","templateId","summaryBlock","content","renderTemplate","getLocalKey","itemId","saveLocalAttributes","key","localStorage","setItem","JSON","stringify","loadLocalAttributes","raw","parse","_unused","clearLocalAttributes","removeItem","withCustomProperties","handler","reject","loadCustomPropertiesAsync","result","AsyncResultStatus","Succeeded","error","Error","loadAttributes","props","get","err","saveAttributes","set","saveAsync","clearAttributes","remove","pushNotification","message","type","_item$notificationMes","notificationMessages","replaceAsync","details","icon","persistent","console","warn","setSelectOptions","placeholder","querySelector","blank","setSelectOptionsWithValue","label","getReportsFormValues","baseUrl","token","buildReportsUrl","normalizeReportItems","payload","_payload$data","reporter","setLatestEmailSummary","el","formatEmailSummary","subject","email_subject","title","name","display_name","full_name","email","address","email_address","formatEmailFrom","from_address","sender","email_from","date","Date","Number","isNaN","getTime","toLocaleString","formatEmailDate","sent_at","created_at","received_at","getFromAddress","normalizeEmailAddress","getMessageId","internetMessageId","messageId","getDateSent","candidate","dateTimeSent","dateTimeCreated","toISOString","_unused2","_loadReportEmails","_callee","_getReportsFormValues","url","response","items","_t","_context","fetch","headers","Accept","Authorization","ok","json","index","id","updateItemCategories","selected","managed","_item$categories","categories","getAsync","normalizeCategory","current","selectedSet","Set","managedSet","remaining","normalized","has","toRemove","toAdd","existing","finish","addCategories","addAsync","addResult","removeThenAdd","removeAsync","removeResult","setAsync","setResult","clearAllCategories","_item$categories2","updateItemImportance","_item$importance","_item$body","body","isComposeItem","importance","isUnsupportedHostError","code","includes","clearNotification","notifications","fallbackReplace","hydrateForm","_hydrateForm","_callee2","_options$preserveForm","preserveForm","_options$allowLocalFa","allowLocalFallback","_options$notify","notify","_t2","_args2","_context2","runAiAnalysis","_handleApply","_callee3","savedToMailbox","selectedCategories","managedCategories","errorText","_t3","_t4","_t5","_t6","_context3","_handleClear","_callee4","errors","recordError","_t7","_t8","_t9","_context4","getItemBodyText","_item$body2","CoercionType","Text","getItemBodyHtml","_item$body3","Html","buildInboxagentUrl","path","buildBasicAuthHeader","secret","btoa","emailAddress","joinEmailAddresses","entries","readRecipientsAsync","field","_getEmails","_callee5","authHeader","count","_t0","_context5","method","results","_syncToInboxagent","_callee6","_yield$Promise$all","_yield$Promise$all2","plain","html","to","cc","_data$metadata","requestId","_t1","_context6","all","_slicedToArray","message_id","encodeURIComponent","metadata","request_id","_runAiAnalysis","_callee7","_options$applyToForm","applyToForm","summaryText","suggestedActions","_t10","_args7","_context7","api_key","rationale","reply_suggestion","_handleAiReply","_callee8","_item$body5","replyText","replyHtml","_t11","_context8","tone","reply_text","coercionType","displayReplyForm","onReady","loadReportEmails","bindClick","addEventListener","handleApply","syncToInboxagent","getEmails","handleClear","_Office$context2","_document$getElementB","_item$body4","displayNewMessageForm","htmlBody","itemClass","inReplyTo","test","appendAsync","handleInsertTemplate","_document$getElementB2","handleReplyWithTemplate","handleAiReply"],"ignoreList":[],"sourceRoot":""}