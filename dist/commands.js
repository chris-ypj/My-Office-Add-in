!function(){function e(e){var t="".concat(window.location.origin,"/dialog/dialog.html"),n=encodeURIComponent(JSON.stringify(e)),c="".concat(t,"?subjects=").concat(n);Office.context.ui.displayDialogAsync(c,{height:35,width:30,displayInIframe:!0},function(){})}Office.onReady(function(){}),"undefined"!=typeof window&&(window.showSubjectPopup=function(t){new Promise(function(e,t){var n=Office.context&&Office.context.mailbox;n?"function"!=typeof n.getSelectedItemsAsync?n.item&&n.item.subject?e([n.item.subject]):e(["(No subject available)"]):n.getSelectedItemsAsync(function(c){if(c.status===Office.AsyncResultStatus.Succeeded){var i=(Array.isArray(c.value)?c.value:[]).map(function(e){return e&&e.subject}).filter(Boolean);0===i.length&&n.item&&n.item.subject?e([n.item.subject]):e(i.length?i:["(No subject available)"])}else t(c.error||new Error("getSelectedItemsAsync failed."))}):t(new Error("Mailbox context not available."))}).then(function(t){return e(t)}).catch(function(t){return e(["Error: ".concat(t&&t.message?t.message:String(t))])}).finally(function(){return t.completed()})})}();
//# sourceMappingURL=commands.js.map