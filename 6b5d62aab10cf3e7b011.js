function showSubjectPopup(e){getSelectedSubjects().then(function(e){return openSubjectsDialog(e)}).catch(function(e){return openSubjectsDialog(["Error: ".concat(e&&e.message?e.message:String(e))])}).finally(function(){return e.completed()})}function getSelectedSubjects(){return new Promise(function(e,t){var n=Office.context&&Office.context.mailbox;n?"function"!=typeof n.getSelectedItemsAsync?n.item&&n.item.subject?e([n.item.subject]):e(["(No subject available)"]):n.getSelectedItemsAsync(function(c){if(c.status===Office.AsyncResultStatus.Succeeded){var o=(Array.isArray(c.value)?c.value:[]).map(function(e){return e&&e.subject}).filter(Boolean);0===o.length&&n.item&&n.item.subject?e([n.item.subject]):e(o.length?o:["(No subject available)"])}else t(c.error||new Error("getSelectedItemsAsync failed."))}):t(new Error("Mailbox context not available."))})}function openSubjectsDialog(e){var t="".concat(window.location.origin,"/dialog/dialog.html"),n=encodeURIComponent(JSON.stringify(e)),c="".concat(t,"?subjects=").concat(n);Office.context.ui.displayDialogAsync(c,{height:35,width:30,displayInIframe:!0},function(){})}Office.onReady(function(){}),"undefined"!=typeof window&&(window.showSubjectPopup=showSubjectPopup);